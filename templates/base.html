{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Sistema de gestiÃ³n para el Centro de Padres y Apoderados">
    <title>{% block title %}Centro de Padres{% endblock %}</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        html, body {
            height: 100%;
        }
        body {
            display: flex;
            flex-direction: column;
            padding-top: 56px; /* Adjust this value based on actual navbar height */
        }
        .welcome-text {
            text-shadow: 0 0 3px white, 0 0 5px white;
        }
        main { /* Changed #root to main */
            flex-grow: 1;
        }
    </style>
</head>
<body>
    {% include 'navbar.html' %}
    
    <main>
        <div id="root">
            <div>
                {% block content %}
                {% endblock content %}
            </div>
        </div>
    </main>
    
    {% include 'footer.html' %}
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggleButton = document.getElementById('theme-toggle');
            const lightIcon = document.getElementById('theme-icon-light');
            const darkIcon = document.getElementById('theme-icon-dark');
            
            const backgroundContainer = document.getElementById('background-container');
            const pageFooter = document.getElementById('page-footer');

            function setTheme(theme) {
                // Update footer
                if (pageFooter) {
                    if (theme === 'dark') {
                        pageFooter.classList.remove('bg-primary');
                        pageFooter.classList.add('bg-dark', 'text-white');
                    } else {
                        pageFooter.classList.remove('bg-dark');
                        pageFooter.classList.add('bg-primary', 'text-white');
                    }
                }

                // Update icons
                if (lightIcon && darkIcon) {
                    if (theme === 'dark') {
                        lightIcon.classList.add('d-none');
                        darkIcon.classList.remove('d-none');
                    } else {
                        darkIcon.classList.add('d-none');
                        lightIcon.classList.remove('d-none');
                    }
                }

                // Update main background if it exists
                if (backgroundContainer) {
                    const lightBg = backgroundContainer.dataset.lightBg;
                    const darkBg = backgroundContainer.dataset.darkBg;
                    if (theme === 'dark') {
                        backgroundContainer.style.backgroundImage = `url('${darkBg}')`;
                    } else {
                        backgroundContainer.style.backgroundImage = `url('${lightBg}')`;
                    }
                }
                
                // Save theme choice
                localStorage.setItem('theme', theme);
            }

            // Set initial theme
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);

            // Add click listener
            if (themeToggleButton) {
                themeToggleButton.addEventListener('click', function() {
                    const currentTheme = localStorage.getItem('theme') || 'light';
                    setTheme(currentTheme === 'light' ? 'dark' : 'light');
                });
            }

            const accordionItems = document.querySelectorAll('.accordion-item-custom');

            accordionItems.forEach(item => {
                const header = item.querySelector('.accordion-header-custom');
                const content = item.querySelector('.accordion-content-custom');
                const icon = header.querySelector('.icon');

                header.addEventListener('click', () => {
                    const isOpen = content.style.maxHeight;

                    // Close all other accordions
                    accordionItems.forEach(otherItem => {
                        if (otherItem !== item) {
                            otherItem.querySelector('.accordion-content-custom').style.maxHeight = null;
                            otherItem.querySelector('.icon').textContent = '+';
                        }
                    });

                    if (isOpen) {
                        content.style.maxHeight = null;
                        icon.textContent = '+';
                    } else {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        icon.textContent = '-';
                    }
                });
            });
        });
    </script>
</body>
</html>
